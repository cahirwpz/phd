--- ncomp.boot	2014-07-22 15:09:09.000000000 +0200
+++ ncomp.boot	2014-07-22 14:59:18.000000000 +0200
@@ -325,6 +325,13 @@
 DEFVAR($globalDefs, nil)
 DEFVAR($MacroTable)
 
+DEFVAR($PostParseHookEnable, false)
+DEFVAR($PostParseHookFunction, nil)
+DEFVAR($PostParseHookDomain, nil)
+
+spadcall(x, fn) ==
+    SPADCALL(x, fn)
+
 S_process(x) ==
     $Index : local := 0
     $MACROASSOC : local := nil
@@ -369,6 +376,21 @@
     $PrintOnly =>
         FORMAT(true, '"~S   =====>~%", $currentLine)
         PRETTYPRINT(x)
+    if $PostParseHookEnable then
+        fn := getFunctionFromDomain($PostParseHookFunction, $PostParseHookDomain, [])
+        FORMAT(true, '"~%~A~%~%", '">>>> POST-PARSE HOOK BEGIN <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<")
+        if null(fn) then
+            SAY("Post-parse hook not found!")
+        else
+            PRETTYPRINT(x)
+            savedBreakMode := $BreakMode
+            $BreakMode := 'trapSpadErrors 
+            r := CATCH('trapSpadErrors,FUNCALL(function spadcall,x,fn))
+            $BreakMode := savedBreakMode
+            if r ~= '(1 . '"failed") then
+                PRETTYPRINT(r)
+                x := r
+        FORMAT(true, '"~%~A~%~%", '">>>> POST-PARSE HOOK END <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<")
     u := compTopLevel(x, $EmptyMode, $InteractiveFrame)
     if u then $InteractiveFrame := THIRD(u)
     if $semanticErrorStack then displaySemanticErrors()
